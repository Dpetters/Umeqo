{% extends "base.html" %}

{% block title %}
Account Settings |
{% endblock %}

{% block metadata %}

{{block.super}}
{% load compress %}
{% compress css %}
    <link rel="stylesheet" href="{{ STATIC_URL }}css/account_base.css" />
{% endcompress %}
{% compress js %}
    <script src="{{ STATIC_URL }}javascript/account_base.js"></script>
{% endcompress %}
{% endblock %}

{% block message_area %}
{{ block.super }}
{% if msg %}
        <p>{{msg}}</p>
{% endif %}
{% endblock %}

{% block content_area %}
<div id="preferences_form_block" class="main_block no_top_margin with_side_nav">
    <div class="main_block_header">
        <img class="main_block_header_icon" src="{{ STATIC_URL }}images/icons/switch.png"/>
        <span class="main_block_header_title">Account Settings</span>
    </div>
    <div class="main_block_content">
        <div id="preferences_form_tabs">
            <ul>
                <li><a href="#tabs-1">Account Overview</a></li>
                <li><a href="#tabs-2">Preferences</a></li>
                {% block preferences_form_tab_declarations %}
                {% endblock %}
            </ul>
            <div id="tabs-1" class="clearfix">
                <div id="account_overview">
                    <h3 class="no_top_margin">Basic Info</h3>
                    <table id="basic_info_table" class="form_table">
                        <tbody>
                            <tr>
                                <th><label>Email:</label></th>
                                <td>
                                    <p>{{user.email}}</p>
                                </td>
                            </tr>
                            {% block basic_info_table_fields %}
                            {% endblock %}
                        </tbody>
                    </table>
                    <form id="password_change_form" method='POST' action="{% url password_change %}">
                        {% csrf_token %}
                        <h3>Change Password</h3>
                        <p class="sub_header_message">By changing your password you will be logged off of all other sessions.</p>
                        <table class="form_table">
                            <tbody>
                                <tr>
                                    <th>{{change_password_form.old_password.label_tag}}</th>
                                    <td>
                                        <div class="errorspace">{{form.old_password.errors}}</div>
                                        {{change_password_form.old_password}}</td>
                                </tr>
                                <tr>
                                    <th>{{change_password_form.new_password1.label_tag}}</th>
                                    <td>
                                        <div class="errorspace">{{form.new_password1.errors}}</div>
                                        {{change_password_form.new_password1}}
                                    </td>
                                </tr>
                                <tr>
                                    <th>{{change_password_form.new_password2.label_tag}}</th>
                                    <td>
                                        <div class="errorspace">{{form.new_password2.errors}}</div>
                                        {{change_password_form.new_password2}}
                                    </td>
                                </tr>
                                <tr>
                                     <div class="error_section error">
                                    </div>
                                </tr>
                                <tr>
                                    <th></th>
                                    <td>
                                        <input class="button" type='submit' value='Change Password'>
                                        <img id='ajax_form_submit_loader' src='{{ STATIC_URL }}images/page_elements/loaders/small_ajax_loader.gif'>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </form>
                    {% block account_overview %}
                    {% endblock %}
                </div>
            </div>
            <div id="tabs-2" class="clearfix">
                <div id="preferences">
                    <h3 class="no_top_margin">Notification Preferences</h3>
                    <p class="sub_header_message">Umeqo provides notifications in the form of emails. They will be sent to <strong>{{user.email}}</strong></p>
                    <p id="global_settings_section">
                        <span>Global Settings</span>
                        <label for="global_email_checkbox">Email Me:</label>
                        <input type="checkbox" id="global_email_checkbox" />
                    </p>
                    {% block preferences %}
                    {% endblock %}
                                <tr>
                                    <td colspan="2" class="error_section error">
                                        {{preferences_form.non_field_errors}}
                                    </td>
                                </tr>
                                <tr>
                                    <td class="button_cell" colspan="2">
                                        <input class="button" type='submit' value='Save Preferences'>
                                        <img id='ajax_form_submit_loader' src='{{ STATIC_URL }}images/page_elements/loaders/small_ajax_loader.gif'>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </form>
                </div>
            </div>
            {% block preferences_form_tab_definitions %}
            {% endblock %}
        </div>
    </div>
</div>
{% endblock %}

